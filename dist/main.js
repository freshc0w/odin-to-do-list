(()=>{"use strict";class t{constructor(t,e,s,i,n){this.name=t,this.description=e,this.dueDate=s,this.priority=i,this.id=n,this.status=!1}set name(t){this._name=t}get name(){return this._name}get id(){return this._id}set id(t){this._id=t}get priority(){return this._priority}set priority(t){this._priority=t}get description(){return this._description}set description(t){this._description=t}get dueDate(){return this._dueDate}set dueDate(t){this._dueDate=t}get dueDateFormatted(){return`${this.dueDate.split("-")[0]}/${this.dueDate.split("-")[1]}/${this.dueDate.split("-")[2]}`}get status(){return this._status}set status(t){this._status=t}}class e{constructor(t){this.name=t,this.tasks=[]}get name(){return this._name}set name(t){this._name=t}get tasks(){return this._tasks}set tasks(t){this._tasks=t}addTask(t){this._tasks.push(t)}deleteTask(t){this._tasks=this._tasks.filter((e=>e.id!==t))}reInitialiseId(){for(let t=0;t<this.tasks.length;t++)this.tasks[t].id=t}}class s{constructor(){this.projects=[],this.projects.push(new e("Inbox")),this.projects.push(new e("Today")),this.projects.push(new e("This Week")),this.projects.push(new e("React"))}get projects(){return this._projects}set projects(t){this._projects=t}contains(t){return this.projects.some((e=>e.name===t))}getProject(t){return this.projects.find((e=>e.name===t))}addProject(t){this.contains(t)||this.projects.push(new e(t))}deleteProject(t){const e=this.projects.find((e=>e.name===t));this.projects.splice(this.projects.indexOf(e),1)}}class i{constructor(t){this.task=t}renderInfo(t,e,s=""){const i=document.createElement(t);return i.classList.add(e),i.textContent=s,i}createElements(t){const e=this.renderInfo("input","statusCheck");e.setAttribute("type","checkbox"),e.setAttribute("id","statusCheck"),this.task.status&&(e.checked=!0,t.style.opacity="40%"),e.addEventListener("change",(e=>{e.target.checked?(this.task.status=!0,t.style.opacity="40%"):(this.task.status=!1,t.style.opacity="100%")}));const s=this.renderInfo("div","taskName",this.task.name),i=this.renderInfo("button","uniqueBtn","Details");i.classList.add("details");const n=this.renderInfo("div","statusPrio"),a=this.renderInfo("i","material-icons","warning");a.classList.add(this.task.priority),n.appendChild(a);const d=this.renderInfo("div","taskDate",this.task.dueDateFormatted),r=this.renderInfo("div","taskEdit"),o=this.renderInfo("i","material-icons","edit");r.appendChild(o);const c=this.renderInfo("div","taskDel"),l=this.renderInfo("i","material-icons","delete");return c.setAttribute("id",`delTask-${this.task.id}`),c.appendChild(l),[e,s,i,n,d,r,c]}draw(){const t=this.renderInfo("div","task-container"),e=this.createElements(t);for(let s of e)t.appendChild(s);return t}}class n{constructor(t){this.project=t}draw(){const t=document.querySelector("#main-content");this.clear(t),this.drawTasks(t,this.project.tasks);const e=this.addTaskOption();t.appendChild(e)}addTaskOption(){const t=document.createElement("div");t.classList.add("task-container"),t.classList.add("add");const e=document.createElement("button");return e.classList.add("uniqueBtn"),e.classList.add("add"),e.textContent="ADD",t.appendChild(e),t}drawTasks(t,e){for(let s of e){const e=new i(s);t.appendChild(e.draw())}}clear(t){t.innerHTML=""}completeTask(){document.getElementById()}}(new class{constructor(){this.toDoList=new s,this.currentProjectPage="Inbox",this.currentForm=(()=>{const t=document.querySelector(".form-container"),e=()=>{const t=document.createElement("img");return t.classList.add("closeFormBtn"),t.src="../../../imgs/mac-close-btn.png",t.alt="A button that closes the form.",t.addEventListener("click",(()=>{const t=document.querySelector("form"),e=document.querySelector(".face-mask");t.style.visibility="hidden",e.style.visibility="hidden"})),t},s=()=>{const t=document.createElement("div"),e=document.createElement("label");e.classList.add("dateLabel"),e.setAttribute("for","inputDueDate"),e.textContent="Due Date:";const s=document.createElement("input");return s.setAttribute("type","date"),s.setAttribute("id","inputDueDate"),s.setAttribute("name","trip-start"),t.appendChild(e),t.appendChild(s),t},i=()=>{const t=document.createElement("div"),e=document.createElement("div"),s=document.createElement("div");t.classList.add("prioWrapper"),s.classList.add("prioOptions"),e.classList.add("prioLabel"),e.textContent="How important is this task?";const i=d("lowPrio","low"),n=d("medPrio","medium"),a=d("highPrio","high");for(let t of[i,n,a])s.appendChild(t);return t.appendChild(e),t.appendChild(s),t;function d(t,e){const s=document.createElement("div"),i=document.createElement("input"),n={type:"radio",id:t,name:"prio",value:e};for(let t in n)i.setAttribute(t,n[t]);const a=document.createElement("label");return a.setAttribute("for",t),a.classList.add(t),a.textContent=e,s.appendChild(i),s.appendChild(a),s}};return{addTask:()=>{const n=((t,e,s,i=!0)=>{const n=document.createElement("div"),a=document.createElement("label");a.setAttribute("for",s),a.textContent=t;const d=document.createElement("input"),r={type:"text",id:s,name:s,placeholder:e};for(let t in r)d.setAttribute(t,r[t]);return d.required=i,n.appendChild(a),n.appendChild(d),n})("Task Title: ","e.g. Learn React in 20 days..","inputTaskTitle");n.classList.add("inputTaskTitle");const a=((t,e,s,i=!0)=>{const n=document.createElement("div"),a=document.createElement("label");a.setAttribute("for",s),a.textContent=t;const d=document.createElement("textarea"),r={id:s,name:s,placeholder:e,rows:6,cols:50};for(let t in r)d.setAttribute(t,r[t]);return d.required=i,n.appendChild(a),n.appendChild(d),n})("Task Details: ","e.g. Not an task. Remember to take breaks and walk outside.","inputTaskDetails");a.classList.add("inputTaskDetails");const d=[n,a,i(),s(),e()];for(let e of d)t.appendChild(e);const r=(()=>{const t=document.createElement("button");return t.classList.add("uniqueBtn"),t.classList.add("appendTaskBtn"),t.textContent="Add Task",t.setAttribute("type","submit"),t})();t.appendChild(r),document.getElementById("medPrio").checked=!0},clear:()=>{for(;t.firstChild;)t.removeChild(t.lastChild)},collectTaskInfo:()=>{const t=document.getElementById("inputTaskTitle"),e=document.getElementById("inputTaskDetails"),s=document.querySelector('input[name="prio"]:checked'),i=document.querySelector("#inputDueDate");return{title:t.value,details:e.value,priority:s.value,date:i.value}}}})()}loadHomePage(){this.addNewTask(this.currentProjectPage,{title:"Walking the dog",details:"He is asking for it so this task is a must",priority:"medium",date:"2023-05-23"}),this.loadSideBar()}loadPage(t){this.toDoList.getProject(t).reInitialiseId(),this.drawPage(t),this.addTaskFunction(t),this.applyDelTaskFunction(t)}drawPage(t){new n(this.toDoList.getProject(t)).draw()}addTaskFunction(t){document.querySelector(".uniqueBtn.add").addEventListener("click",(()=>{this.currentForm.clear(),this.currentForm.addTask(),document.getElementById("medPrio").checked=!0,document.querySelector("form").style.visibility="visible",document.querySelector(".face-mask").style.visibility="visible",inputDueDate.valueAsDate=new Date;const e=document.querySelector(".uniqueBtn.appendTaskBtn");this.submitTaskFunction(e,t)}))}addNewTask(e,s){this.toDoList.getProject(e).addTask(new t(s.title,s.details,s.date,s.priority,this.toDoList.getProject(e).tasks.length)),this.loadPage(e)}submitTaskFunction(t,e){t.addEventListener("click",(t=>{if(document.querySelector("form").checkValidity()){const s=this.currentForm.collectTaskInfo();this.addNewTask(e,s),document.querySelector("form").style.visibility="hidden",document.querySelector(".face-mask").style.visibility="hidden",t.preventDefault()}}))}removeTaskFunction(t,e){document.getElementById(`delTask-${e}`).addEventListener("click",(()=>{this.toDoList.getProject(t).deleteTask(e),this.loadPage(t)}))}applyDelTaskFunction(t){this.toDoList.getProject(t).tasks.map((e=>{this.removeTaskFunction(t,e.id)}))}loadSideBar(){this.addSlideInOut(),this.drawInboxTabs(),this.drawProjectTabs()}drawInboxTabs(){const t=document.createElement("ul");this.addTab(t,"Today"),this.addTab(t,"This Week");const e=document.querySelector(".inbox-bar");e.appendChild(t),this.addDropDownMenu(e,t)}drawProjectTabs(){const t=["Inbox","Today","This Week"],e=this.toDoList.projects.filter((e=>!t.includes(e.name))),s=document.createElement("ul");for(let t of e)this.addTab(s,t.name);const i=document.querySelector(".project-bar");i.appendChild(s),this.addDropDownMenu(i,s)}addDropDownMenu(t,e){t.addEventListener("mouseover",(()=>{e.style.display="block"})),t.addEventListener("mouseout",(()=>{e.style.display="none"}))}addTab(t,e){const s=document.createElement("li");s.textContent=this.toDoList.getProject(e).name,t.appendChild(s)}addSlideInOut(){const t=document.getElementById("sideBar");t.addEventListener("mouseover",(()=>{t.style.width="200px"})),t.addEventListener("mouseout",(()=>{t.style.width="65px"}))}}).loadHomePage()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LENBQUMsUUFBUyxRQUFTLGFBQ25DQyxFQUFpQjlKLEtBQUtvRixTQUFTNUQsU0FBU0wsUUFDNUNVLElBQWFnSSxFQUFjRSxTQUFTbEksRUFBUWxDLFFBR3hDcUssRUFBY3BILFNBQVNDLGNBQWMsTUFDM0MsSUFBSyxJQUFJaEIsS0FBV2lJLEVBQ25COUosS0FBSzBKLE9BQU9NLEVBQWFuSSxFQUFRbEMsTUFHbEMsTUFBTXNLLEVBQWFySCxTQUFTNEIsY0FBYyxnQkFDMUN5RixFQUFXcEcsWUFBWW1HLEdBQ3ZCaEssS0FBSzRKLGdCQUFnQkssRUFBWUQsRUFDbEMsQ0FFQUosZ0JBQWdCTSxFQUFTQyxHQUV4QkQsRUFBUTFHLGlCQUFpQixhQUFhLEtBQ3JDMkcsRUFBSzdHLE1BQU04RyxRQUFVLE9BQU8sSUFFN0JGLEVBQVExRyxpQkFBaUIsWUFBWSxLQUNwQzJHLEVBQUs3RyxNQUFNOEcsUUFBVSxNQUFNLEdBRTdCLENBQ0FWLE9BQU9XLEVBQVMxSSxHQUVmLE1BQU0ySSxFQUFNMUgsU0FBU0MsY0FBYyxNQUVuQ3lILEVBQUl0SCxZQUFjaEQsS0FBS29GLFNBQVN0RCxXQUFXSCxHQUFhaEMsS0FDeEQwSyxFQUFReEcsWUFBWXlHLEVBQ3JCLENBRUFoQixnQkFDQyxNQUFNaUIsRUFBVTNILFNBQVN1QyxlQUFlLFdBQ3hDb0YsRUFBUS9HLGlCQUFpQixhQUFhLEtBQ3JDK0csRUFBUWpILE1BQU1rSCxNQUFRLE9BQU8sSUFFOUJELEVBQVEvRyxpQkFBaUIsWUFBWSxLQUNwQytHLEVBQVFqSCxNQUFNa0gsTUFBUSxNQUFNLEdBRTlCLElEM0thcEMsYyIsInNvdXJjZXMiOlsid2VicGFjazovL29kaW4tdG8tZG8tbGlzdC8uL3NyYy9tb2R1bGVzL3Rhc2suanMiLCJ3ZWJwYWNrOi8vb2Rpbi10by1kby1saXN0Ly4vc3JjL21vZHVsZXMvcHJvamVjdC5qcyIsIndlYnBhY2s6Ly9vZGluLXRvLWRvLWxpc3QvLi9zcmMvbW9kdWxlcy9BbGxQcm9qZWN0cy5qcyIsIndlYnBhY2s6Ly9vZGluLXRvLWRvLWxpc3QvLi9zcmMvbW9kdWxlcy9VSS9Qcm9qZWN0VUkuanMiLCJ3ZWJwYWNrOi8vb2Rpbi10by1kby1saXN0Ly4vc3JjL2luZGV4LmpzIiwid2VicGFjazovL29kaW4tdG8tZG8tbGlzdC8uL3NyYy9tb2R1bGVzL1VJLmpzIiwid2VicGFjazovL29kaW4tdG8tZG8tbGlzdC8uL3NyYy9tb2R1bGVzL1VJL2Zvcm0uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGFzayB7XG4gICAgY29uc3RydWN0b3IobmFtZSwgZGVzY3JpcHRpb24sIGR1ZURhdGUsIHByaW9yaXR5LCBpZCkge1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gICAgICAgIHRoaXMuZHVlRGF0ZSA9IGR1ZURhdGU7XG4gICAgICAgIHRoaXMucHJpb3JpdHkgPSBwcmlvcml0eTtcbiAgICAgICAgdGhpcy5pZCA9IGlkOyAvLyBUbyBhbGxvdyBkZWxldGlvbiBvZiB0YXNrIHdpdGggdGhlIHNhbWUgbmFtZTtcbiAgICAgICAgdGhpcy5zdGF0dXMgPSBmYWxzZTtcbiAgICAgICAgXG4gICAgfVxuICAgIHNldCBuYW1lKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX25hbWUgPSB2YWx1ZTtcbiAgICB9O1xuXG4gICAgZ2V0IG5hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9uYW1lO1xuICAgIH07XG4gICAgXG4gICAgZ2V0IGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faWQ7XG4gICAgfTtcbiAgICBzZXQgaWQodmFsdWUpIHtcbiAgICAgICAgdGhpcy5faWQgPSB2YWx1ZTtcbiAgICB9XG4gICAgZ2V0IHByaW9yaXR5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcHJpb3JpdHk7XG4gICAgfVxuICAgIHNldCBwcmlvcml0eSh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9wcmlvcml0eSA9IHZhbHVlO1xuICAgIH1cbiAgICBcbiAgICBnZXQgZGVzY3JpcHRpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kZXNjcmlwdGlvbjtcbiAgICB9O1xuICAgIHNldCBkZXNjcmlwdGlvbih2YWx1ZSkge1xuICAgICAgICB0aGlzLl9kZXNjcmlwdGlvbiA9IHZhbHVlO1xuICAgIH07XG5cbiAgICBnZXQgZHVlRGF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2R1ZURhdGU7XG4gICAgfTtcbiAgICBzZXQgZHVlRGF0ZSh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9kdWVEYXRlID0gdmFsdWU7XG4gICAgfVxuICAgIGdldCBkdWVEYXRlRm9ybWF0dGVkKCkge1xuICAgICAgICBjb25zdCBkYXkgPSB0aGlzLmR1ZURhdGUuc3BsaXQoJy0nKVswXTtcbiAgICAgICAgY29uc3QgbW9udGggPSB0aGlzLmR1ZURhdGUuc3BsaXQoJy0nKVsxXTtcbiAgICAgICAgY29uc3QgeWVhciA9IHRoaXMuZHVlRGF0ZS5zcGxpdCgnLScpWzJdO1xuXG4gICAgICAgIHJldHVybiBgJHtkYXl9LyR7bW9udGh9LyR7eWVhcn1gO1xuICAgIH07XG4gICAgZ2V0IHN0YXR1cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N0YXR1cztcbiAgICB9O1xuICAgIHNldCBzdGF0dXModmFsdWUpIHtcbiAgICAgICAgdGhpcy5fc3RhdHVzID0gdmFsdWU7XG4gICAgfVxufTsiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQcm9qZWN0IHtcbiAgICBjb25zdHJ1Y3RvcihuYW1lKSB7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMudGFza3MgPSBbXTtcbiAgICB9O1xuICAgIFxuICAgIGdldCBuYW1lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbmFtZTtcbiAgICB9O1xuICAgIHNldCBuYW1lKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX25hbWUgPSB2YWx1ZTtcbiAgICB9O1xuICAgIGdldCB0YXNrcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Rhc2tzO1xuICAgIH07XG4gICAgc2V0IHRhc2tzKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3Rhc2tzID0gdmFsdWU7XG4gICAgfVxuICAgIGFkZFRhc2sodGFzaykge1xuICAgICAgICB0aGlzLl90YXNrcy5wdXNoKHRhc2spOyAgICAgICAgXG4gICAgfTtcbiAgICBkZWxldGVUYXNrKHRhc2tJZCkge1xuICAgICAgICB0aGlzLl90YXNrcyA9IHRoaXMuX3Rhc2tzLmZpbHRlcih0YXNrID0+IHRhc2suaWQgIT09IHRhc2tJZCk7XG4gICAgfTtcbiAgICByZUluaXRpYWxpc2VJZCgpIHtcbiAgICAgICAgZm9yKGxldCBuZXdJZCA9IDA7IG5ld0lkIDwgdGhpcy50YXNrcy5sZW5ndGg7IG5ld0lkKyspIHtcbiAgICAgICAgICAgIHRoaXMudGFza3NbbmV3SWRdLmlkID0gbmV3SWQ7IFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gVG8gYmUgYWRkZWQ6IEdldCB0b2RheSdzIGFuZCB0aGlzIHdlZWsncyB0YXNrcy4gXG59OyIsImltcG9ydCBUYXNrIGZyb20gXCIuL3Rhc2tcIjtcbmltcG9ydCBQcm9qZWN0IGZyb20gXCIuL3Byb2plY3RcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQWxsUHJvamVjdHMge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnByb2plY3RzID0gW107XG4gICAgICAgIHRoaXMucHJvamVjdHMucHVzaChuZXcgUHJvamVjdCgnSW5ib3gnKSk7XG4gICAgICAgIHRoaXMucHJvamVjdHMucHVzaChuZXcgUHJvamVjdCgnVG9kYXknKSk7XG4gICAgICAgIHRoaXMucHJvamVjdHMucHVzaChuZXcgUHJvamVjdCgnVGhpcyBXZWVrJykpO1xuICAgICAgICB0aGlzLnByb2plY3RzLnB1c2gobmV3IFByb2plY3QoJ1JlYWN0JykpO1xuICAgIH07XG5cbiAgICBnZXQgcHJvamVjdHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wcm9qZWN0cztcbiAgICB9O1xuICAgIHNldCBwcm9qZWN0cyh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9wcm9qZWN0cyA9IHZhbHVlO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGlmIHByb2plY3QgbmFtZSBleGlzdHMgaW4gbGlzdCBvZiBwcm9qZWN0cy5cbiAgICBjb250YWlucyhwcm9qZWN0TmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9qZWN0cy5zb21lKHByb2plY3QgPT4gcHJvamVjdC5uYW1lID09PSBwcm9qZWN0TmFtZSk7XG4gICAgfTtcblxuICAgIGdldFByb2plY3QocHJvamVjdE5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvamVjdHMuZmluZChwcm9qZWN0ID0+IHByb2plY3QubmFtZSA9PT0gcHJvamVjdE5hbWUpO1xuICAgIH07XG5cbiAgICBhZGRQcm9qZWN0KG5ld1Byb2plY3ROYW1lKSB7XG4gICAgICAgIC8vIENhbm5vdCBoYXZlIHNhbWUgcHJvamVjdCBuYW1lcy5cbiAgICAgICAgaWYgKHRoaXMuY29udGFpbnMobmV3UHJvamVjdE5hbWUpKSByZXR1cm47XG4gICAgICAgIHRoaXMucHJvamVjdHMucHVzaChuZXcgUHJvamVjdChuZXdQcm9qZWN0TmFtZSkpO1xuICAgIH07XG5cbiAgICBkZWxldGVQcm9qZWN0KHByb2plY3ROYW1lKSB7XG4gICAgICAgIGNvbnN0IHByb2plY3RUb0RlbGV0ZSA9IHRoaXMucHJvamVjdHMuZmluZChwcm9qZWN0ID0+IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9qZWN0Lm5hbWUgPT09IHByb2plY3ROYW1lKTtcbiAgICAgICAgdGhpcy5wcm9qZWN0cy5zcGxpY2UodGhpcy5wcm9qZWN0cy5pbmRleE9mKHByb2plY3RUb0RlbGV0ZSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEpXG4gICAgfTtcbiAgICBcblxuICAgIC8vIENhbiBhZGQgdG9kYXkncyBhbmQgdGhpcyB3ZWVrJ3MgZnVuY3Rpb25hbGl0eS5cbn07IiwiaW1wb3J0IFRhc2sgZnJvbSBcIi4uL3Rhc2tcIjtcbmltcG9ydCBQcm9qZWN0IGZyb20gXCIuLi9wcm9qZWN0XCI7XG5cbmNsYXNzIFRhc2tVSSB7XG5cdC8vIFB1cnBvc2Ugb2YgdGhpcyBjbGFzcyBpdCB0byB0YWtlIGluIGEgdGFzayBvYmosIGFuZCB0dXJuIGl0IGludG9cblx0Ly8gYSBkaXYgd2l0aCBhbGwgcmVsZXZhbnQgaW5mb3JtYXRpb24gcmVnYXJkaW5nIHRoZSB0YXNrLlxuXHQvLyBGcm9tIGxlZnQtdG8tcmlnaHQ6IFtjaGVja0JveCwgbmFtZSwgZGV0YWlscywgcHJpb3JpdHksIGRhdGUsIGVkaXRJY29uLCBiaW5JY29uXVxuXHRjb25zdHJ1Y3Rvcih0YXNrT2JqKSB7XG5cdFx0dGhpcy50YXNrID0gdGFza09iajtcblx0fVxuXHRyZW5kZXJJbmZvKGVsZW0sIGFkZGVkQ2xhc3MsIHRleHQgPSBcIlwiKSB7XG5cdFx0Y29uc3QgbmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZWxlbSk7XG5cdFx0bmFtZS5jbGFzc0xpc3QuYWRkKGFkZGVkQ2xhc3MpO1xuXHRcdG5hbWUudGV4dENvbnRlbnQgPSB0ZXh0OyAvLyBkZWZhdWx0IGVtcHR5IHN0clxuXG5cdFx0cmV0dXJuIG5hbWU7XG5cdH1cblx0Y3JlYXRlRWxlbWVudHModGFza0NvbnRhaW5lcikge1xuXHRcdGNvbnN0IHN0YXR1c0NoZWNrID0gdGhpcy5yZW5kZXJJbmZvKFwiaW5wdXRcIiwgXCJzdGF0dXNDaGVja1wiKTtcblx0XHRzdGF0dXNDaGVjay5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwiY2hlY2tib3hcIik7XG5cdFx0c3RhdHVzQ2hlY2suc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJzdGF0dXNDaGVja1wiKTtcblxuXHRcdC8vIENoZWNrIGlmIHRhc2sgaGFzIGFscmVhZHkgYmVlbiBjaGVja2VkIG9mZiBiZWZvcmUuXG5cdFx0aWYgKHRoaXMudGFzay5zdGF0dXMpIHtcblx0XHRcdHN0YXR1c0NoZWNrLmNoZWNrZWQgPSB0cnVlO1xuXHRcdFx0dGFza0NvbnRhaW5lci5zdHlsZS5vcGFjaXR5ID0gXCI0MCVcIjtcblx0XHR9XG5cblx0XHRzdGF0dXNDaGVjay5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIChldmVudCkgPT4ge1xuXHRcdFx0aWYgKGV2ZW50LnRhcmdldC5jaGVja2VkKSB7XG5cdFx0XHRcdHRoaXMudGFzay5zdGF0dXMgPSB0cnVlO1xuXHRcdFx0XHR0YXNrQ29udGFpbmVyLnN0eWxlLm9wYWNpdHkgPSBcIjQwJVwiO1xuXHRcdFx0XHQvLyB0YXNrQ29udGFpbmVyLnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZSgwLjk4NSknO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy50YXNrLnN0YXR1cyA9IGZhbHNlO1xuXHRcdFx0XHR0YXNrQ29udGFpbmVyLnN0eWxlLm9wYWNpdHkgPSBcIjEwMCVcIjtcblx0XHRcdFx0Ly8gdGFza0NvbnRhaW5lci5zdHlsZS50cmFuc2Zvcm0gPSAnc2NhbGUoMSknO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Y29uc3QgbmFtZSA9IHRoaXMucmVuZGVySW5mbyhcImRpdlwiLCBcInRhc2tOYW1lXCIsIHRoaXMudGFzay5uYW1lKTtcblxuXHRcdC8vIFdoZW4gY2xpY2tlZCwgcG9wIHVwIGEgZm9ybSB3aGVyZSB0aGUgZGV0YWlscyBvZiB0aGUgdGFzayBpcyBkaXNwbGF5ZWQuXG5cdFx0Y29uc3QgZGV0YWlsc0J0biA9IHRoaXMucmVuZGVySW5mbyhcImJ1dHRvblwiLCBcInVuaXF1ZUJ0blwiLCBcIkRldGFpbHNcIik7XG5cdFx0ZGV0YWlsc0J0bi5jbGFzc0xpc3QuYWRkKFwiZGV0YWlsc1wiKTtcblxuXHRcdC8vIFByaW9yaXR5IGljb25cblx0XHRjb25zdCBwcmlvcml0eSA9IHRoaXMucmVuZGVySW5mbyhcImRpdlwiLCBcInN0YXR1c1ByaW9cIik7XG5cdFx0Y29uc3QgcHJpb3JpdHlJY29uID0gdGhpcy5yZW5kZXJJbmZvKFwiaVwiLCBcIm1hdGVyaWFsLWljb25zXCIsIFwid2FybmluZ1wiKTtcblxuXHRcdC8vIENoYW5nZSBjb2xvciBiYXNlZCBvbiBwcmlvcml0eSBvZiB0YXNrIC0+IFsnaGlnaCcsICdtZWRpdW0nLCAnbG93J11cblx0XHRwcmlvcml0eUljb24uY2xhc3NMaXN0LmFkZCh0aGlzLnRhc2sucHJpb3JpdHkpO1xuXHRcdHByaW9yaXR5LmFwcGVuZENoaWxkKHByaW9yaXR5SWNvbik7XG5cblx0XHQvLyBKdXN0IGEgbW9jayBkYXRlIGZvciBub3cuIFN1YmplY3QgdG8gY2hhbmdlIGJhc2VkIG9uIHVzZXIgaW5wdXQuXG5cdFx0Ly8gY29uc3QgdGltZUVsYXBzZWQgPSBEYXRlLm5vdygpO1xuXHRcdC8vIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUodGltZUVsYXBzZWQpO1xuXHRcdC8vIGNvbnN0IGRhdGUgPSB0aGlzLnJlbmRlckluZm8oXG5cdFx0Ly8gXHRcImRpdlwiLFxuXHRcdC8vIFx0XCJ0YXNrRGF0ZVwiLFxuXHRcdC8vIFx0YCR7dG9kYXkudG9Mb2NhbGVEYXRlU3RyaW5nKCl9YFxuXHRcdC8vICk7XG5cblx0XHRjb25zdCBkYXRlID0gdGhpcy5yZW5kZXJJbmZvKFwiZGl2XCIsIFwidGFza0RhdGVcIiwgdGhpcy50YXNrLmR1ZURhdGVGb3JtYXR0ZWQpO1xuXG5cdFx0Ly8gaWNvbnNcblx0XHRjb25zdCBlZGl0ID0gdGhpcy5yZW5kZXJJbmZvKFwiZGl2XCIsIFwidGFza0VkaXRcIik7XG5cdFx0Y29uc3QgZWRpdEljb24gPSB0aGlzLnJlbmRlckluZm8oXCJpXCIsIFwibWF0ZXJpYWwtaWNvbnNcIiwgXCJlZGl0XCIpO1xuXHRcdGVkaXQuYXBwZW5kQ2hpbGQoZWRpdEljb24pO1xuXG5cdFx0Y29uc3QgdGFza0RlbCA9IHRoaXMucmVuZGVySW5mbyhcImRpdlwiLCBcInRhc2tEZWxcIik7XG5cdFx0Y29uc3QgZGVsSWNvbiA9IHRoaXMucmVuZGVySW5mbyhcImlcIiwgXCJtYXRlcmlhbC1pY29uc1wiLCBcImRlbGV0ZVwiKTtcblxuXHRcdC8vIEFkZCB1bmlxdWUgaWQgaWRlbnRpZmVyIGJhc2VkIG9uIHRhc2sgaWQgZm9yIGJpbiBpY29uLlxuXHRcdHRhc2tEZWwuc2V0QXR0cmlidXRlKFwiaWRcIiwgYGRlbFRhc2stJHt0aGlzLnRhc2suaWR9YCk7XG5cblx0XHQvLyBDcmVhdGUgRGF0YXNldD8/XG5cdFx0Ly8gZGVsSWNvbi5kYXRhc2V0LmlkID0gdGhpcy50YXNrLmlkO1xuXG5cdFx0dGFza0RlbC5hcHBlbmRDaGlsZChkZWxJY29uKTtcblxuXHRcdHJldHVybiBbc3RhdHVzQ2hlY2ssIG5hbWUsIGRldGFpbHNCdG4sIHByaW9yaXR5LCBkYXRlLCBlZGl0LCB0YXNrRGVsXTtcblx0fVxuXHRkcmF3KCkge1xuXHRcdGNvbnN0IHRhc2tDb250YWluZXIgPSB0aGlzLnJlbmRlckluZm8oXCJkaXZcIiwgXCJ0YXNrLWNvbnRhaW5lclwiKTtcblx0XHRjb25zdCBlbGVtcyA9IHRoaXMuY3JlYXRlRWxlbWVudHModGFza0NvbnRhaW5lcik7XG5cdFx0Zm9yIChsZXQgZWxlbSBvZiBlbGVtcykge1xuXHRcdFx0dGFza0NvbnRhaW5lci5hcHBlbmRDaGlsZChlbGVtKTtcblx0XHR9XG5cdFx0cmV0dXJuIHRhc2tDb250YWluZXI7XG5cdH1cbn1cblxuY2xhc3MgUHJvamVjdFVJIHtcblx0Y29uc3RydWN0b3IocHJvamVjdE9iaikge1xuXHRcdHRoaXMucHJvamVjdCA9IHByb2plY3RPYmo7XG5cdH1cblx0ZHJhdygpIHtcblx0XHRjb25zdCBtYWluQ29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbWFpbi1jb250ZW50XCIpO1xuXHRcdHRoaXMuY2xlYXIobWFpbkNvbnRlbnQpO1xuXG5cdFx0Ly8gTG9vcCB0aHJvdWdoIGFsbCB0aGUgdGFza3MgYW5kIGdpdmUgaXQgYSBUYXNrVUkgY2xhc3MuXG5cdFx0Ly8gVXNlIHRoZSBkcmF3IG1ldGhvZCB0byBnZXQgdGhlIGRpdiBjb250YWluZXIgYW5kIGFwcGVuZCBpdCB0b1xuXHRcdC8vIG1haW5Db250ZW50IGNvbnRhaW5lci5cblx0XHR0aGlzLmRyYXdUYXNrcyhtYWluQ29udGVudCwgdGhpcy5wcm9qZWN0LnRhc2tzKTtcblxuXHRcdGNvbnN0IGFkZFRhc2tPcHRpb24gPSB0aGlzLmFkZFRhc2tPcHRpb24oKTtcblx0XHRtYWluQ29udGVudC5hcHBlbmRDaGlsZChhZGRUYXNrT3B0aW9uKTtcblx0fVxuXHRhZGRUYXNrT3B0aW9uKCkge1xuXHRcdC8vIERyYXcgYW4gYWRkIHRhc2sgb3B0aW9uIGJlbmVhdGggYWxsIHRhc2tzXG5cdFx0Y29uc3QgYWRkVGFza0NvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0YWRkVGFza0NvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwidGFzay1jb250YWluZXJcIik7XG5cdFx0YWRkVGFza0NvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiYWRkXCIpO1xuXG5cdFx0Y29uc3QgYWRkVGFza0J0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG5cdFx0YWRkVGFza0J0bi5jbGFzc0xpc3QuYWRkKFwidW5pcXVlQnRuXCIpO1xuXHRcdGFkZFRhc2tCdG4uY2xhc3NMaXN0LmFkZChcImFkZFwiKTtcblx0XHRhZGRUYXNrQnRuLnRleHRDb250ZW50ID0gXCJBRERcIjtcblxuXHRcdGFkZFRhc2tDb250YWluZXIuYXBwZW5kQ2hpbGQoYWRkVGFza0J0bik7XG5cdFx0cmV0dXJuIGFkZFRhc2tDb250YWluZXI7XG5cdH1cblx0ZHJhd1Rhc2tzKGNvbnRhaW5lciwgdGFza3MpIHtcblx0XHRmb3IgKGxldCB0YXNrIG9mIHRhc2tzKSB7XG5cdFx0XHRjb25zdCB0YXNrRGlzcGxheSA9IG5ldyBUYXNrVUkodGFzayk7XG5cdFx0XHRjb250YWluZXIuYXBwZW5kQ2hpbGQodGFza0Rpc3BsYXkuZHJhdygpKTtcblx0XHR9XG5cdH1cblxuXHRjbGVhcihjb250ZW50KSB7XG5cdFx0Y29udGVudC5pbm5lckhUTUwgPSBcIlwiO1xuXHR9XG5cblx0Y29tcGxldGVUYXNrKCkge1xuXHRcdC8vIE1ha2UgdGFzayBjb250YWluZXIgdHJhbnNwYXJlbnQgYWZ0ZXIgY29tcGxldGluZyB0YXNrLlxuXHRcdGNvbnN0IGNoZWNrQm94ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoKTtcblx0fVxufVxuXG5leHBvcnQgeyBUYXNrVUksIFByb2plY3RVSSB9O1xuIiwiaW1wb3J0IFVJIGZyb20gJy4vbW9kdWxlcy9VSSc7XG5jb25zdCBVc2VySW50ZXJmYWNlID0gbmV3IFVJKCk7XG5cblVzZXJJbnRlcmZhY2UubG9hZEhvbWVQYWdlKCk7IiwiaW1wb3J0IFRhc2sgZnJvbSBcIi4vdGFza1wiO1xuaW1wb3J0IFByb2plY3QgZnJvbSBcIi4vcHJvamVjdFwiO1xuaW1wb3J0IEFsbFByb2plY3RzIGZyb20gXCIuL0FsbFByb2plY3RzXCI7XG5pbXBvcnQgeyBUYXNrVUksIFByb2plY3RVSSB9IGZyb20gXCIuL1VJL1Byb2plY3RVSVwiO1xuaW1wb3J0IHsgRHJhd0Zvcm0gfSBmcm9tIFwiLi9VSS9mb3JtXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFVJIHtcblx0Y29uc3RydWN0b3IoKSB7XG5cdFx0dGhpcy50b0RvTGlzdCA9IG5ldyBBbGxQcm9qZWN0cygpO1xuXG5cdFx0Ly8gSW5pdGlhbGlzZSBmaXJzdCBob21lUGFnZSB0byBiZSBvbiB0aGUgXCJJbmJveFwiIHBhZ2UuXG5cdFx0dGhpcy5jdXJyZW50UHJvamVjdFBhZ2UgPSBcIkluYm94XCI7XG5cdFx0dGhpcy5jdXJyZW50Rm9ybSA9IERyYXdGb3JtKCk7XG5cdH1cblxuXHRsb2FkSG9tZVBhZ2UoKSB7XG5cdFx0Ly8gSW5pdGlhbGlzZSBmaXJzdCBkdW1teSB0YXNrOlxuXHRcdGNvbnN0IHRhc2sxID0ge1xuXHRcdFx0dGl0bGU6IFwiV2Fsa2luZyB0aGUgZG9nXCIsXG5cdFx0XHRkZXRhaWxzOiBcIkhlIGlzIGFza2luZyBmb3IgaXQgc28gdGhpcyB0YXNrIGlzIGEgbXVzdFwiLFxuXHRcdFx0cHJpb3JpdHk6IFwibWVkaXVtXCIsXG5cdFx0XHRkYXRlOiBcIjIwMjMtMDUtMjNcIixcblx0XHR9O1xuXHRcdHRoaXMuYWRkTmV3VGFzayh0aGlzLmN1cnJlbnRQcm9qZWN0UGFnZSwgdGFzazEpO1xuXG5cdFx0dGhpcy5sb2FkU2lkZUJhcigpO1xuXHR9XG5cblx0bG9hZFBhZ2UocHJvamVjdE5hbWUpIHtcblx0XHQvLyBXZSBuZWVkIHRvIHJlc2V0IGFsbCBpZHMgb24gYWxsIHRhc2tzIHRvIHByZXZlbnRcblx0XHQvLyBkZWxldGlvbiBvZiB0d28gdGFza3Mgd2l0aCB0aGUgc2FtZSBpZCBhdCBvbmNlLlxuXHRcdHRoaXMudG9Eb0xpc3QuZ2V0UHJvamVjdChwcm9qZWN0TmFtZSkucmVJbml0aWFsaXNlSWQoKTtcblxuXHRcdHRoaXMuZHJhd1BhZ2UocHJvamVjdE5hbWUpO1xuXG5cdFx0Ly8gUmVpbml0aWFsaXNlIGFkZCB0YXNrIGZ1bmN0aW9uIGZvciBuZXcgcGFnZSdzIGJ0bi5cblx0XHR0aGlzLmFkZFRhc2tGdW5jdGlvbihwcm9qZWN0TmFtZSk7XG5cdFx0Ly8gQXBwbHkgZXZlbnRsaXN0ZW5lcnMgZm9yIGVhY2ggY29ycmVzcG9uZGluZyBiaW4gaWNvbnMuXG5cdFx0dGhpcy5hcHBseURlbFRhc2tGdW5jdGlvbihwcm9qZWN0TmFtZSk7XG5cdH1cblxuXHRkcmF3UGFnZShwcm9qZWN0TmFtZSkge1xuXHRcdGNvbnN0IHByb2plY3REaXNwbGF5ID0gbmV3IFByb2plY3RVSSh0aGlzLnRvRG9MaXN0LmdldFByb2plY3QocHJvamVjdE5hbWUpKTtcblx0XHRwcm9qZWN0RGlzcGxheS5kcmF3KCk7XG5cdH1cblxuXHQvKiBCdXR0b24gZnVuY3Rpb25hbGl0aWVzICovXG5cdGFkZFRhc2tGdW5jdGlvbihwcm9qZWN0TmFtZSkge1xuXHRcdGNvbnN0IGFkZFRhc2tCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnVuaXF1ZUJ0bi5hZGRcIik7XG5cdFx0YWRkVGFza0J0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuXG5cdFx0XHQvLyBDbGVhciBhbnkgY3VycmVudCBmb3JtIGFuZCBkcmF3IHRoZSBhZGQgdGFzayBmb3JtLlxuXHRcdFx0dGhpcy5jdXJyZW50Rm9ybS5jbGVhcigpO1xuXHRcdFx0dGhpcy5jdXJyZW50Rm9ybS5hZGRUYXNrKCk7XG5cdFx0XHQvLyBTZXQgdGhlIGRlZmF1bHQgY2hlY2tlZCByYWRpbyBidXR0b24gdG8gTWVkaXVtIFByaW9yaXR5LlxuXHRcdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtZWRQcmlvXCIpLmNoZWNrZWQgPSB0cnVlO1xuXHRcdFx0XG5cdFx0XHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiZm9ybVwiKS5zdHlsZS52aXNpYmlsaXR5ID0gXCJ2aXNpYmxlXCI7XG5cdFx0XHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZhY2UtbWFza1wiKS5zdHlsZS52aXNpYmlsaXR5ID0gXCJ2aXNpYmxlXCI7XG5cblx0XHRcdC8vIFNldCBkZWZhdWx0IGRhdGUgaW5wdXQgdG8gY3VycmVudCBkYXkuXG5cdFx0XHRpbnB1dER1ZURhdGUudmFsdWVBc0RhdGUgPSBuZXcgRGF0ZSgpO1xuXG5cdFx0XHQvLyBBZGQgZHJhdyBuZXcgdGFzayBmdW5jdGlvbmFsaXR5IHRvIGFwcGVuZFRhc2tCdG4gb24gdGhlIGZvcm0uXG5cdFx0XHRjb25zdCBhcHBlbmRUYXNrQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi51bmlxdWVCdG4uYXBwZW5kVGFza0J0blwiKTtcblx0XHRcdHRoaXMuc3VibWl0VGFza0Z1bmN0aW9uKGFwcGVuZFRhc2tCdG4sIHByb2plY3ROYW1lKTtcblx0XHR9KTtcblx0fVxuXG5cdGFkZE5ld1Rhc2socHJvamVjdE5hbWUsIHRhc2tJbmZvKSB7XG5cdFx0dGhpcy50b0RvTGlzdFxuXHRcdFx0LmdldFByb2plY3QocHJvamVjdE5hbWUpXG5cdFx0XHQuYWRkVGFzayhcblx0XHRcdFx0bmV3IFRhc2soXG5cdFx0XHRcdFx0dGFza0luZm9bXCJ0aXRsZVwiXSxcblx0XHRcdFx0XHR0YXNrSW5mb1tcImRldGFpbHNcIl0sXG5cdFx0XHRcdFx0dGFza0luZm9bXCJkYXRlXCJdLFxuXHRcdFx0XHRcdHRhc2tJbmZvW1wicHJpb3JpdHlcIl0sXG5cdFx0XHRcdFx0dGhpcy50b0RvTGlzdC5nZXRQcm9qZWN0KHByb2plY3ROYW1lKS50YXNrcy5sZW5ndGhcblx0XHRcdFx0KVxuXHRcdFx0KTtcblx0XHR0aGlzLmxvYWRQYWdlKHByb2plY3ROYW1lKTtcblx0fVxuXG5cdHN1Ym1pdFRhc2tGdW5jdGlvbihidG4sIHByb2plY3ROYW1lKSB7XG5cdFx0YnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcblx0XHRcdGlmKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2Zvcm0nKS5jaGVja1ZhbGlkaXR5KCkpe1xuXHRcdFx0XHRjb25zdCB0YXNrSW5mbyA9IHRoaXMuY3VycmVudEZvcm0uY29sbGVjdFRhc2tJbmZvKCk7XG5cdFx0XHRcdHRoaXMuYWRkTmV3VGFzayhwcm9qZWN0TmFtZSwgdGFza0luZm8pO1xuXHRcblx0XHRcdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImZvcm1cIikuc3R5bGUudmlzaWJpbGl0eSA9IFwiaGlkZGVuXCI7XG5cdFx0XHRcdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZmFjZS1tYXNrXCIpLnN0eWxlLnZpc2liaWxpdHkgPSBcImhpZGRlblwiO1x0XHRcblx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdHJlbW92ZVRhc2tGdW5jdGlvbihwcm9qZWN0TmFtZSwgdGFza0lkKSB7XG5cdFx0Ly8gQWRkIGRlbGV0ZSB0YXNrIGZ1bmN0aW9ucyBmb3IgZWFjaCBleGlzdGluZyB0YXNrVUkuXG5cdFx0Y29uc3QgZGVsSW1nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYGRlbFRhc2stJHt0YXNrSWR9YCk7XG5cdFx0ZGVsSW1nLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG5cdFx0XHR0aGlzLnRvRG9MaXN0LmdldFByb2plY3QocHJvamVjdE5hbWUpLmRlbGV0ZVRhc2sodGFza0lkKTtcblx0XHRcdHRoaXMubG9hZFBhZ2UocHJvamVjdE5hbWUpO1xuXHRcdH0pO1xuXHR9XG5cdGFwcGx5RGVsVGFza0Z1bmN0aW9uKHByb2plY3ROYW1lKSB7XG5cdFx0Ly8gRm9yIGFsbCB0aGUgdGFza3MgaW4gdGhlIHByb2plY3QsIGFkZCByZW1vdmVUYXNrIGZ1bmN0aW9uYWxpdHkgZm9yXG5cdFx0Ly8gZWFjaCB0YXNrLlxuXHRcdHRoaXMudG9Eb0xpc3QuZ2V0UHJvamVjdChwcm9qZWN0TmFtZSkudGFza3MubWFwKCh0YXNrKSA9PiB7XG5cdFx0XHR0aGlzLnJlbW92ZVRhc2tGdW5jdGlvbihwcm9qZWN0TmFtZSwgdGFzay5pZCk7XG5cdFx0fSk7XG5cdH1cblxuXHQvKiBTaWRlQmFyIGZ1bmN0aW9uYWxpdGllcyAqL1xuXHRsb2FkU2lkZUJhcigpIHtcblx0XHR0aGlzLmFkZFNsaWRlSW5PdXQoKTtcblx0XHR0aGlzLmRyYXdJbmJveFRhYnMoKTtcblx0XHR0aGlzLmRyYXdQcm9qZWN0VGFicygpO1xuXHR9XG5cblx0ZHJhd0luYm94VGFicygpIHtcblx0XHQvLyBBZGQgdG9kYXkgYW5kIHRoaXMgd2VlaydzIHRhc2sgYmVuZWF0aCBJbmJveCB0YWIgc2lkZWJhci5cblx0XHRjb25zdCBpbmJveFRhYnMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidWxcIik7XG5cblx0XHR0aGlzLmFkZFRhYihpbmJveFRhYnMsIFwiVG9kYXlcIik7XG5cdFx0dGhpcy5hZGRUYWIoaW5ib3hUYWJzLCBcIlRoaXMgV2Vla1wiKTtcblxuXHRcdGNvbnN0IGluYm94QmFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5pbmJveC1iYXJcIik7XG5cdFx0aW5ib3hCYXIuYXBwZW5kQ2hpbGQoaW5ib3hUYWJzKTtcblx0XHR0aGlzLmFkZERyb3BEb3duTWVudShpbmJveEJhciwgaW5ib3hUYWJzKTtcblx0fVxuXG5cdGRyYXdQcm9qZWN0VGFicygpIHtcblx0XHQvLyBGaW5kIGFsbCBvdGhlciBwcm9qZWN0cy5cblx0XHRjb25zdCBpbmJveFByb2plY3RzID0gW1wiSW5ib3hcIiwgXCJUb2RheVwiLCBcIlRoaXMgV2Vla1wiXTtcblx0XHRjb25zdCBjdXN0b21Qcm9qZWN0cyA9IHRoaXMudG9Eb0xpc3QucHJvamVjdHMuZmlsdGVyKFxuXHRcdFx0KHByb2plY3QpID0+ICFpbmJveFByb2plY3RzLmluY2x1ZGVzKHByb2plY3QubmFtZSlcblx0XHQpO1xuXG5cdFx0Y29uc3QgcHJvamVjdFRhYnMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidWxcIik7XG5cdFx0Zm9yIChsZXQgcHJvamVjdCBvZiBjdXN0b21Qcm9qZWN0cykge1xuXHRcdFx0dGhpcy5hZGRUYWIocHJvamVjdFRhYnMsIHByb2plY3QubmFtZSk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgcHJvamVjdEJhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC1iYXJcIik7XG5cdFx0cHJvamVjdEJhci5hcHBlbmRDaGlsZChwcm9qZWN0VGFicyk7XG5cdFx0dGhpcy5hZGREcm9wRG93bk1lbnUocHJvamVjdEJhciwgcHJvamVjdFRhYnMpO1xuXHR9XG5cblx0YWRkRHJvcERvd25NZW51KG1lbnVCYXIsIHRhYnMpIHtcblx0XHQvLyBUYWJzIHdpbGwgYmUgZWxvbmdhdGVkIGJhc2VkIG9uIHRhYiBob3ZlcmVkLlxuXHRcdG1lbnVCYXIuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3ZlclwiLCAoKSA9PiB7XG5cdFx0XHR0YWJzLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG5cdFx0fSk7XG5cdFx0bWVudUJhci5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdXRcIiwgKCkgPT4ge1xuXHRcdFx0dGFicy5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG5cdFx0fSk7XG5cdH1cblx0YWRkVGFiKG1lbnVUYWIsIHByb2plY3ROYW1lKSB7XG5cdFx0Ly8gQ3JlYXRlIGxpIGFuZCBhcHBlbmQgaXQgdG8gZ2l2ZW4gcGFyYW0gZWxlbS5cblx0XHRjb25zdCB0YWIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlcIik7XG5cblx0XHR0YWIudGV4dENvbnRlbnQgPSB0aGlzLnRvRG9MaXN0LmdldFByb2plY3QocHJvamVjdE5hbWUpLm5hbWU7XG5cdFx0bWVudVRhYi5hcHBlbmRDaGlsZCh0YWIpO1xuXHR9XG5cblx0YWRkU2xpZGVJbk91dCgpIHtcblx0XHRjb25zdCBzaWRlQmFyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzaWRlQmFyXCIpO1xuXHRcdHNpZGVCYXIuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3ZlclwiLCAoKSA9PiB7XG5cdFx0XHRzaWRlQmFyLnN0eWxlLndpZHRoID0gXCIyMDBweFwiO1xuXHRcdH0pO1xuXHRcdHNpZGVCYXIuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3V0XCIsICgpID0+IHtcblx0XHRcdHNpZGVCYXIuc3R5bGUud2lkdGggPSBcIjY1cHhcIjtcblx0XHR9KTtcblx0fVxufVxuIiwiZXhwb3J0IHtEcmF3Rm9ybX1cblxuY29uc3QgRHJhd0Zvcm0gPSAoKSA9PiB7XG4gICAgLy8gV2hlbiB1c2VyIHByZXNzZXMgYWRkIHRhc2ssIHBvcCB1cCBhIGZvcm0gdGhhdCBhc2tzIGZvciBhbGwgcmVxIGlucHV0LlxuICAgIC8vIFRoaXMgaW5jbHVkZXMgW3Rhc2tOYW1lLCBkZXRhaWxzLCBwcmlvcml0eUxldmVsLCBEYXRlXTtcbiAgICBjb25zdCBmb3JtQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm0tY29udGFpbmVyJyk7XG5cbiAgICBjb25zdCBjbGVhciA9ICgpID0+IHtcbiAgICAgICAgd2hpbGUoZm9ybUNvbnRhaW5lci5maXJzdENoaWxkKSB7XG4gICAgICAgICAgICBmb3JtQ29udGFpbmVyLnJlbW92ZUNoaWxkKGZvcm1Db250YWluZXIubGFzdENoaWxkKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgXG4gICAgY29uc3QgYWRkVGFzayA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgdGFza1RpdGxlID0gYWRkSW5wdXRUZXh0KCdUYXNrIFRpdGxlOiAnLCAnZS5nLiBMZWFybiBSZWFjdCBpbiAnICtcbiAgICAgICAgJzIwIGRheXMuLicsICdpbnB1dFRhc2tUaXRsZScpO1xuICAgICAgICB0YXNrVGl0bGUuY2xhc3NMaXN0LmFkZCgnaW5wdXRUYXNrVGl0bGUnKTtcblxuICAgICAgICBjb25zdCB0YXNrRGV0YWlscyA9IGFkZFRleHRBcmVhKCdUYXNrIERldGFpbHM6ICcsICdlLmcuIE5vdCBhbiAnICtcbiAgICAgICAgJ3Rhc2suIFJlbWVtYmVyIHRvIHRha2UgYnJlYWtzIGFuZCB3YWxrIG91dHNpZGUuJyxcbiAgICAgICAgICdpbnB1dFRhc2tEZXRhaWxzJyk7XG4gICAgICAgIHRhc2tEZXRhaWxzLmNsYXNzTGlzdC5hZGQoJ2lucHV0VGFza0RldGFpbHMnKTsgXG4gICAgICAgIFxuICAgICAgICBjb25zdCBwcmlvT3B0aW9ucyA9IGFkZFByaW9yaXR5T3B0aW9ucygpO1xuICAgICAgICBjb25zdCBkdWVEYXRlID0gYWRkSW5wdXREdWVEYXRlKCk7XG4gICAgICAgIGNvbnN0IGNsb3NlRm9ybU9wdGlvbiA9IGFkZENsb3NlRm9ybUZ1bmN0aW9uKCk7XG5cbiAgICAgICAgY29uc3QgdGFza3NJbmZvID0gW3Rhc2tUaXRsZSwgdGFza0RldGFpbHMsIHByaW9PcHRpb25zLCBkdWVEYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlRm9ybU9wdGlvbl07XG5cbiAgICAgICAgZm9yKGxldCBpbmZvIG9mIHRhc2tzSW5mbykge1xuICAgICAgICAgICAgZm9ybUNvbnRhaW5lci5hcHBlbmRDaGlsZChpbmZvKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBBZGQgc3VibWl0IGJ0bi5cbiAgICAgICAgY29uc3QgYXBwZW5kVGFza0J0biA9IGFkZEFwcGVuZFRhc2tCdG4oKTtcbiAgICAgICAgXG4gICAgICAgIGZvcm1Db250YWluZXIuYXBwZW5kQ2hpbGQoYXBwZW5kVGFza0J0bik7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWVkUHJpb1wiKS5jaGVja2VkID0gdHJ1ZTtcbiAgICB9O1xuICAgIFxuICAgIGNvbnN0IGFkZEFwcGVuZFRhc2tCdG4gPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGFwcGVuZFRhc2tCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICAgICAgYXBwZW5kVGFza0J0bi5jbGFzc0xpc3QuYWRkKCd1bmlxdWVCdG4nKTtcbiAgICAgICAgYXBwZW5kVGFza0J0bi5jbGFzc0xpc3QuYWRkKCdhcHBlbmRUYXNrQnRuJyk7XG4gICAgICAgIGFwcGVuZFRhc2tCdG4udGV4dENvbnRlbnQgPSAnQWRkIFRhc2snO1xuICAgICAgICBhcHBlbmRUYXNrQnRuLnNldEF0dHJpYnV0ZShcInR5cGVcIiwgXCJzdWJtaXRcIik7XG4gICAgICAgIFxuICAgICAgICAvLyBhcHBlbmRUYXNrQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgLy8gICAgIGFwcGVuZFRhc2tGdW5jdGlvbihldmVudClcbiAgICAgICAgLy8gfSk7XG5cbiAgICAgICAgcmV0dXJuIGFwcGVuZFRhc2tCdG47XG4gICAgfVxuXG4gICAgY29uc3QgY29sbGVjdFRhc2tJbmZvID0gKCkgPT4ge1xuICAgICAgICAvLyBDb2xsZWN0IGFsbCByZWxldmFudCBpbmZvcm1hdGlvbiBiYXNlZCBvbiB1c2VyIGlucHV0IGFuZCByZXR1cm5cbiAgICAgICAgLy8gaXQgaW4gYW4gb2JqLlxuICAgICAgICBjb25zdCB0YXNrVGl0bGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5wdXRUYXNrVGl0bGUnKTtcbiAgICAgICAgY29uc3QgdGFza0RldGFpbHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5wdXRUYXNrRGV0YWlscycpO1xuICAgICAgICBjb25zdCBwcmlvQ2hvc2VuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICAgICAgICdpbnB1dFtuYW1lPVwicHJpb1wiXTpjaGVja2VkJyk7XG4gICAgICAgIGNvbnN0IGRhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjaW5wdXREdWVEYXRlJyk7XG5cbiAgICAgICAgY29uc3QgdGFza0luZm8gPSB7XG4gICAgICAgICAgICAndGl0bGUnOiB0YXNrVGl0bGUudmFsdWUsXG4gICAgICAgICAgICAnZGV0YWlscyc6IHRhc2tEZXRhaWxzLnZhbHVlLFxuICAgICAgICAgICAgJ3ByaW9yaXR5JzogcHJpb0Nob3Nlbi52YWx1ZSxcbiAgICAgICAgICAgICdkYXRlJzogZGF0ZS52YWx1ZSxcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHRhc2tJbmZvOyBcbiAgICB9XG5cbiAgICBjb25zdCBhZGRDbG9zZUZvcm1GdW5jdGlvbiA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgY2xvc2VGb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XG4gICAgICAgIGNsb3NlRm9ybS5jbGFzc0xpc3QuYWRkKCdjbG9zZUZvcm1CdG4nKTtcbiAgICAgICAgY2xvc2VGb3JtLnNyYyA9ICcuLi8uLi8uLi9pbWdzL21hYy1jbG9zZS1idG4ucG5nJztcbiAgICAgICAgY2xvc2VGb3JtLmFsdCA9ICdBIGJ1dHRvbiB0aGF0IGNsb3NlcyB0aGUgZm9ybS4nO1xuXG4gICAgICAgIGNsb3NlRm9ybS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdmb3JtJyk7XG4gICAgICAgICAgICBjb25zdCBvdmVybGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZhY2UtbWFzaycpO1xuICAgICAgICAgICAgZm9ybS5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XG4gICAgICAgICAgICBvdmVybGF5LnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJztcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGNsb3NlRm9ybTtcbiAgICB9O1xuXG4gICAgY29uc3QgYWRkSW5wdXREdWVEYXRlID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBkdWVEYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cbiAgICAgICAgY29uc3QgZGF0ZUxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKTtcbiAgICAgICAgZGF0ZUxhYmVsLmNsYXNzTGlzdC5hZGQoJ2RhdGVMYWJlbCcpO1xuICAgICAgICBkYXRlTGFiZWwuc2V0QXR0cmlidXRlKCdmb3InLCAnaW5wdXREdWVEYXRlJyk7XG4gICAgICAgIGRhdGVMYWJlbC50ZXh0Q29udGVudCA9ICdEdWUgRGF0ZTonO1xuXG4gICAgICAgIGNvbnN0IGlucHV0RHVlRGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgICAgIGlucHV0RHVlRGF0ZS5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCBcImRhdGVcIik7XG4gICAgICAgIGlucHV0RHVlRGF0ZS5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2lucHV0RHVlRGF0ZScpO1xuICAgICAgICBpbnB1dER1ZURhdGUuc2V0QXR0cmlidXRlKCduYW1lJywgJ3RyaXAtc3RhcnQnKTtcblxuICAgICAgICBkdWVEYXRlLmFwcGVuZENoaWxkKGRhdGVMYWJlbCk7XG4gICAgICAgIGR1ZURhdGUuYXBwZW5kQ2hpbGQoaW5wdXREdWVEYXRlKTtcbiAgICAgICAgcmV0dXJuIGR1ZURhdGU7XG4gICAgfVxuXG4gICAgY29uc3QgYWRkUHJpb3JpdHlPcHRpb25zID0gKCkgPT4ge1xuICAgICAgICAvLyBBIHdyYXBwZXIgaXMgZ29pbmcgdG8gd3JhcCB0aGUgbGFiZWwgYW5kIGEgY29udGFpbmVyIGNvbnNpc3Rpbmcgb2ZcbiAgICAgICAgLy8gdGhlIHJhZGlvIG9wdGlvbnMuIFxuICAgICAgICBjb25zdCBpbnB1dFByaW9XcmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGNvbnN0IGxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGNvbnN0IHByaW9PcHRpb25zQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGlucHV0UHJpb1dyYXBwZXIuY2xhc3NMaXN0LmFkZCgncHJpb1dyYXBwZXInKVxuICAgICAgICBwcmlvT3B0aW9uc0NvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdwcmlvT3B0aW9ucycpO1xuXG4gICAgICAgIGxhYmVsLmNsYXNzTGlzdC5hZGQoJ3ByaW9MYWJlbCcpO1xuICAgICAgICBsYWJlbC50ZXh0Q29udGVudCA9IFwiSG93IGltcG9ydGFudCBpcyB0aGlzIHRhc2s/XCI7XG4gICAgICAgIGNvbnN0IGxvd1ByaW8gPSBjcmVhdGVSYWRpb0lucHV0QW5kTGFiZWwoJ2xvd1ByaW8nLCAnbG93Jyk7XG4gICAgICAgIGNvbnN0IG1lZFByaW8gPSBjcmVhdGVSYWRpb0lucHV0QW5kTGFiZWwoJ21lZFByaW8nLCAnbWVkaXVtJyk7XG4gICAgICAgIGNvbnN0IGhpZ2hQcmlvID0gY3JlYXRlUmFkaW9JbnB1dEFuZExhYmVsKCdoaWdoUHJpbycsICdoaWdoJyk7XG5cbiAgICAgICAgZm9yKGxldCBwcmlvT3B0aW9ucyBvZiBbbG93UHJpbywgbWVkUHJpbywgaGlnaFByaW9dKSB7XG4gICAgICAgICAgICBwcmlvT3B0aW9uc0NvbnRhaW5lci5hcHBlbmRDaGlsZChwcmlvT3B0aW9ucyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgaW5wdXRQcmlvV3JhcHBlci5hcHBlbmRDaGlsZChsYWJlbCk7XG4gICAgICAgIGlucHV0UHJpb1dyYXBwZXIuYXBwZW5kQ2hpbGQocHJpb09wdGlvbnNDb250YWluZXIpO1xuICAgICAgICByZXR1cm4gaW5wdXRQcmlvV3JhcHBlcjtcblxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVSYWRpb0lucHV0QW5kTGFiZWwoaWQsIHZhbHVlKSB7XG4gICAgICAgICAgICBjb25zdCByYWRpb09wdGlvbkNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IHtcbiAgICAgICAgICAgICAgICBcInR5cGVcIjogXCJyYWRpb1wiLFxuICAgICAgICAgICAgICAgIFwiaWRcIjogaWQsXG4gICAgICAgICAgICAgICAgXCJuYW1lXCI6ICdwcmlvJyxcbiAgICAgICAgICAgICAgICBcInZhbHVlXCI6IHZhbHVlLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGZvcihsZXQgYXR0ciBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgaW5wdXQuc2V0QXR0cmlidXRlKGF0dHIsIGF0dHJpYnV0ZXNbYXR0cl0pO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgY29uc3QgbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpO1xuICAgICAgICAgICAgbGFiZWwuc2V0QXR0cmlidXRlKCdmb3InLCBpZCk7XG4gICAgICAgICAgICBsYWJlbC5jbGFzc0xpc3QuYWRkKGlkKTtcbiAgICAgICAgICAgIGxhYmVsLnRleHRDb250ZW50ID0gdmFsdWU7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJhZGlvT3B0aW9uQ29udGFpbmVyLmFwcGVuZENoaWxkKGlucHV0KTtcbiAgICAgICAgICAgIHJhZGlvT3B0aW9uQ29udGFpbmVyLmFwcGVuZENoaWxkKGxhYmVsKTtcbiAgICAgICAgICAgIHJldHVybiByYWRpb09wdGlvbkNvbnRhaW5lcjtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBjb25zdCBhZGRUZXh0QXJlYSA9IChsYWJlbE5hbWUsIHBsYWNlaG9sZGVyLCBpZCwgcmVxdWlyZWQ9dHJ1ZSkgPT4ge1xuICAgICAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXG4gICAgICAgIGNvbnN0IGlucHV0TGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpO1xuICAgICAgICBpbnB1dExhYmVsLnNldEF0dHJpYnV0ZSgnZm9yJywgaWQpO1xuICAgICAgICBpbnB1dExhYmVsLnRleHRDb250ZW50ID0gbGFiZWxOYW1lO1xuXG4gICAgICAgIGNvbnN0IGlucHV0VGV4dEFyZWEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScpO1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0ge1xuICAgICAgICAgICAgJ2lkJzogaWQsXG4gICAgICAgICAgICAnbmFtZSc6IGlkLFxuICAgICAgICAgICAgJ3BsYWNlaG9sZGVyJzogcGxhY2Vob2xkZXIsXG4gICAgICAgICAgICAncm93cyc6IDYsXG4gICAgICAgICAgICAnY29scyc6IDUwLFxuICAgICAgICB9O1xuXG4gICAgICAgIGZvcihsZXQgYXR0cklkeCBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICBpbnB1dFRleHRBcmVhLnNldEF0dHJpYnV0ZShhdHRySWR4LCBhdHRyaWJ1dGVzW2F0dHJJZHhdKVxuICAgICAgICB9XG4gICAgICAgIGlucHV0VGV4dEFyZWEucmVxdWlyZWQgPSByZXF1aXJlZDsgLy8gRGVmYXVsdCBUcnVlXG5cbiAgICAgICAgaW5wdXQuYXBwZW5kQ2hpbGQoaW5wdXRMYWJlbCk7XG4gICAgICAgIGlucHV0LmFwcGVuZENoaWxkKGlucHV0VGV4dEFyZWEpO1xuICAgICAgICByZXR1cm4gaW5wdXRcbiAgICB9XG5cbiAgICBjb25zdCBhZGRJbnB1dFRleHQgPSAobGFiZWxOYW1lLCBwbGFjZWhvbGRlciwgaWQsIHJlcXVpcmVkPXRydWUpID0+IHtcbiAgICAgICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblxuICAgICAgICBjb25zdCBpbnB1dExhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKTtcbiAgICAgICAgaW5wdXRMYWJlbC5zZXRBdHRyaWJ1dGUoJ2ZvcicsIGlkKTtcbiAgICAgICAgaW5wdXRMYWJlbC50ZXh0Q29udGVudCA9IGxhYmVsTmFtZTtcblxuICAgICAgICBjb25zdCBpbnB1dFRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0ge1xuICAgICAgICAgICAgJ3R5cGUnOiAndGV4dCcsXG4gICAgICAgICAgICAnaWQnOiBpZCxcbiAgICAgICAgICAgICduYW1lJzogaWQsXG4gICAgICAgICAgICAncGxhY2Vob2xkZXInOiBwbGFjZWhvbGRlclxuICAgICAgICB9O1xuICAgICAgICBmb3IobGV0IGF0dHJJZHggaW4gYXR0cmlidXRlcykge1xuICAgICAgICAgICAgaW5wdXRUZXh0LnNldEF0dHJpYnV0ZShhdHRySWR4LCBhdHRyaWJ1dGVzW2F0dHJJZHhdKVxuICAgICAgICB9XG5cbiAgICAgICAgaW5wdXRUZXh0LnJlcXVpcmVkID0gcmVxdWlyZWQ7IFxuXG4gICAgICAgIGlucHV0LmFwcGVuZENoaWxkKGlucHV0TGFiZWwpO1xuICAgICAgICBpbnB1dC5hcHBlbmRDaGlsZChpbnB1dFRleHQpO1xuICAgICAgICByZXR1cm4gaW5wdXQ7XG4gICAgfVxuICAgIHJldHVybiB7IGFkZFRhc2ssIGNsZWFyLCBjb2xsZWN0VGFza0luZm8gfTtcblxuXG59Il0sIm5hbWVzIjpbIlRhc2siLCJjb25zdHJ1Y3RvciIsIm5hbWUiLCJkZXNjcmlwdGlvbiIsImR1ZURhdGUiLCJwcmlvcml0eSIsImlkIiwidGhpcyIsInN0YXR1cyIsInZhbHVlIiwiX25hbWUiLCJfaWQiLCJfcHJpb3JpdHkiLCJfZGVzY3JpcHRpb24iLCJfZHVlRGF0ZSIsImR1ZURhdGVGb3JtYXR0ZWQiLCJzcGxpdCIsIl9zdGF0dXMiLCJQcm9qZWN0IiwidGFza3MiLCJfdGFza3MiLCJhZGRUYXNrIiwidGFzayIsInB1c2giLCJkZWxldGVUYXNrIiwidGFza0lkIiwiZmlsdGVyIiwicmVJbml0aWFsaXNlSWQiLCJuZXdJZCIsImxlbmd0aCIsIkFsbFByb2plY3RzIiwicHJvamVjdHMiLCJfcHJvamVjdHMiLCJjb250YWlucyIsInByb2plY3ROYW1lIiwic29tZSIsInByb2plY3QiLCJnZXRQcm9qZWN0IiwiZmluZCIsImFkZFByb2plY3QiLCJuZXdQcm9qZWN0TmFtZSIsImRlbGV0ZVByb2plY3QiLCJwcm9qZWN0VG9EZWxldGUiLCJzcGxpY2UiLCJpbmRleE9mIiwiVGFza1VJIiwidGFza09iaiIsInJlbmRlckluZm8iLCJlbGVtIiwiYWRkZWRDbGFzcyIsInRleHQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJ0ZXh0Q29udGVudCIsImNyZWF0ZUVsZW1lbnRzIiwidGFza0NvbnRhaW5lciIsInN0YXR1c0NoZWNrIiwic2V0QXR0cmlidXRlIiwiY2hlY2tlZCIsInN0eWxlIiwib3BhY2l0eSIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsInRhcmdldCIsImRldGFpbHNCdG4iLCJwcmlvcml0eUljb24iLCJhcHBlbmRDaGlsZCIsImRhdGUiLCJlZGl0IiwiZWRpdEljb24iLCJ0YXNrRGVsIiwiZGVsSWNvbiIsImRyYXciLCJlbGVtcyIsIlByb2plY3RVSSIsInByb2plY3RPYmoiLCJtYWluQ29udGVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjbGVhciIsImRyYXdUYXNrcyIsImFkZFRhc2tPcHRpb24iLCJhZGRUYXNrQ29udGFpbmVyIiwiYWRkVGFza0J0biIsImNvbnRhaW5lciIsInRhc2tEaXNwbGF5IiwiY29udGVudCIsImlubmVySFRNTCIsImNvbXBsZXRlVGFzayIsImdldEVsZW1lbnRCeUlkIiwidG9Eb0xpc3QiLCJjdXJyZW50UHJvamVjdFBhZ2UiLCJjdXJyZW50Rm9ybSIsImZvcm1Db250YWluZXIiLCJhZGRDbG9zZUZvcm1GdW5jdGlvbiIsImNsb3NlRm9ybSIsInNyYyIsImFsdCIsImZvcm0iLCJvdmVybGF5IiwidmlzaWJpbGl0eSIsImFkZElucHV0RHVlRGF0ZSIsImRhdGVMYWJlbCIsImlucHV0RHVlRGF0ZSIsImFkZFByaW9yaXR5T3B0aW9ucyIsImlucHV0UHJpb1dyYXBwZXIiLCJsYWJlbCIsInByaW9PcHRpb25zQ29udGFpbmVyIiwibG93UHJpbyIsImNyZWF0ZVJhZGlvSW5wdXRBbmRMYWJlbCIsIm1lZFByaW8iLCJoaWdoUHJpbyIsInByaW9PcHRpb25zIiwicmFkaW9PcHRpb25Db250YWluZXIiLCJpbnB1dCIsImF0dHJpYnV0ZXMiLCJhdHRyIiwidGFza1RpdGxlIiwibGFiZWxOYW1lIiwicGxhY2Vob2xkZXIiLCJyZXF1aXJlZCIsImlucHV0TGFiZWwiLCJpbnB1dFRleHQiLCJhdHRySWR4IiwiYWRkSW5wdXRUZXh0IiwidGFza0RldGFpbHMiLCJpbnB1dFRleHRBcmVhIiwiYWRkVGV4dEFyZWEiLCJ0YXNrc0luZm8iLCJpbmZvIiwiYXBwZW5kVGFza0J0biIsImFkZEFwcGVuZFRhc2tCdG4iLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJsYXN0Q2hpbGQiLCJjb2xsZWN0VGFza0luZm8iLCJwcmlvQ2hvc2VuIiwiRHJhd0Zvcm0iLCJsb2FkSG9tZVBhZ2UiLCJhZGROZXdUYXNrIiwidGl0bGUiLCJkZXRhaWxzIiwibG9hZFNpZGVCYXIiLCJsb2FkUGFnZSIsImRyYXdQYWdlIiwiYWRkVGFza0Z1bmN0aW9uIiwiYXBwbHlEZWxUYXNrRnVuY3Rpb24iLCJ2YWx1ZUFzRGF0ZSIsIkRhdGUiLCJzdWJtaXRUYXNrRnVuY3Rpb24iLCJ0YXNrSW5mbyIsImJ0biIsImNoZWNrVmFsaWRpdHkiLCJwcmV2ZW50RGVmYXVsdCIsInJlbW92ZVRhc2tGdW5jdGlvbiIsIm1hcCIsImFkZFNsaWRlSW5PdXQiLCJkcmF3SW5ib3hUYWJzIiwiZHJhd1Byb2plY3RUYWJzIiwiaW5ib3hUYWJzIiwiYWRkVGFiIiwiaW5ib3hCYXIiLCJhZGREcm9wRG93bk1lbnUiLCJpbmJveFByb2plY3RzIiwiY3VzdG9tUHJvamVjdHMiLCJpbmNsdWRlcyIsInByb2plY3RUYWJzIiwicHJvamVjdEJhciIsIm1lbnVCYXIiLCJ0YWJzIiwiZGlzcGxheSIsIm1lbnVUYWIiLCJ0YWIiLCJzaWRlQmFyIiwid2lkdGgiXSwic291cmNlUm9vdCI6IiJ9